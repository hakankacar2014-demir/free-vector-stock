<script>
    const OWNER = 'hakankacar2014-demir';
    const REPO = 'free-vector-stock';

    async function load() {
        const gallery = document.getElementById('gallery');
        try {
            const res = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/vectors`);
            const dirs = await res.json();
            
            for(let d of dirs) {
                if(d.type === 'dir') {
                    const fRes = await fetch(d.url);
                    const files = await fRes.json();
                    const jpg = files.find(f => f.name.toLowerCase().endsWith('.jpg')).download_url;
                    const eps = files.find(f => f.name.toLowerCase().endsWith('.eps')).download_url;
                    
                    const card = `
                        <div class="card">
                            <img src="${jpg}">
                            <p>${d.name.replace(/-/g, ' ').toUpperCase()}</p>
                            <button class="btn" onclick="forceDownload('${eps}', '${d.name}.eps')">EPS İNDİR</button>
                        </div>`;
                    gallery.innerHTML += card;
                }
            }
        } catch(e) { console.log("Yükleme hatası:", e); }
    }

    // Dosyayı kod olarak açmak yerine bilgisayara indiren sihirli fonksiyon
    function forceDownload(url, filename) {
        fetch(url)
            .then(response => response.blob())
            .then(blob => {
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            })
            .catch(e => console.error('İndirme hatası:', e));
    }

    load();
</script>
